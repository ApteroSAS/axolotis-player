{"version":3,"file":"index.js","mappings":"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","sources":["webpack://axolotis-player/webpack/universalModuleDefinition","webpack://axolotis-player/webpack/runtime/load script","webpack://axolotis-player/./src/lib/modules/FrameLoop.ts","webpack://axolotis-player/./src/lib/modules/core/WorldService.ts","webpack://axolotis-player/./src/lib/generated/webpack/module/ClassNameConverter.ts","webpack://axolotis-player/./src/lib/modules/core/loader/WebpackLoader.ts","webpack://axolotis-player/./src/lib/generated/webpack/module/WebpackLoader.ts","webpack://axolotis-player/./src/lib/modules/core/loader/JsLoader.ts","webpack://axolotis-player/./src/lib/modules/core/loader/LocalLoader.ts","webpack://axolotis-player/./src/lib/modules/core/service/LazyServices.ts","webpack://axolotis-player/./src/lib/modules/core/service/ServiceEntity.ts","webpack://axolotis-player/webpack/bootstrap","webpack://axolotis-player/webpack/runtime/define property getters","webpack://axolotis-player/webpack/runtime/ensure chunk","webpack://axolotis-player/webpack/runtime/get javascript chunk filename","webpack://axolotis-player/webpack/runtime/get mini-css chunk filename","webpack://axolotis-player/webpack/runtime/global","webpack://axolotis-player/webpack/runtime/hasOwnProperty shorthand","webpack://axolotis-player/webpack/runtime/make namespace object","webpack://axolotis-player/webpack/runtime/publicPath","webpack://axolotis-player/webpack/runtime/jsonp chunk loading","webpack://axolotis-player/./src/lib/modules/core/loader/CodeLoaderComponent.ts","webpack://axolotis-player/./src/lib/modules/core/loader/CodeLoader.ts","webpack://axolotis-player/./src/lib/modules/core/ecs/Entity.ts","webpack://axolotis-player/./src/lib/modules/core/ecs/WorldEntity.ts","webpack://axolotis-player/./src/lib/modules/core/loader/CoreInit.ts","webpack://axolotis-player/./src/lib/modules/core/loader/AssetsLoader.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"axolotis-player\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"axolotis-player\"] = factory();\n\telse\n\t\troot[\"axolotis-player\"] = factory();\n})(self, function() {\nreturn ","var inProgress = {};\nvar dataWebpackPrefix = \"axolotis-player:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","import Component from \"@root/lib/modules/core/ecs/Component\";\n\nimport { CodeLoaderComponent } from \"@root/lib/modules/core/loader/CodeLoaderComponent\";\nimport {\n  LazyServices,\n  Service,\n} from \"@root/lib/modules/core/service/LazyServices\";\nimport { WebpackLazyModule } from \"@root/lib/modules/core/loader/WebpackLoader\";\n\nexport class Factory implements WebpackLazyModule, Service<FrameLoop> {\n  async createService(services: LazyServices): Promise<FrameLoop> {\n    let codeLoader = await services.getService<CodeLoaderComponent>(\n      \"@root/lib/modules/core/loader/CodeLoaderService\"\n    );\n    let module = new FrameLoop();\n    codeLoader.awaitInitialLoading().then(() => {\n      module.startAnimationFrameLoop();\n    });\n    return module;\n  }\n}\n\nexport class FrameLoop implements Component {\n  //TODO frame loop\n  // setInterval Frameloop\n  // animationFrame\n  // Physic update\n  // low workload adaptative loop? Like when FPS is green we execute code once evry Frame when it is not we execute once every seconde.\n  // worker loop?\n  // stats for all those loop (stats.js)\n  // API to add task consumer?\n  //callbacks:((delta:number)=>void)[] = [];\n  loops: { [id: string]: (delta: number) => void } = {};\n  private prevTime: number = 0;\n  private monitoringStart: (name) => void = () => {};\n  private monitoringEnd: (name) => void = () => {};\n  constructor() {}\n\n  startAnimationFrameLoop() {\n    const animate = (t) => {\n      this.monitoringStart(FrameLoop.name);\n      const delta = t - this.prevTime;\n      this.prevTime = t;\n      requestAnimationFrame(animate);\n      for (const callback in this.loops) {\n        this.monitoringStart(callback);\n        this.loops[callback](delta);\n        this.monitoringEnd(callback);\n      }\n      this.monitoringEnd(FrameLoop.name);\n    };\n    requestAnimationFrame(animate);\n  }\n\n  setMonitoringCallback(start: (name) => void, end: (name) => void) {\n    this.monitoringStart = start;\n    this.monitoringEnd = end;\n  }\n\n  removeLoop(loopName: string) {\n    delete this.loops[loopName];\n    this.monitoringStart(loopName); //set this loop to 0 fix\n    this.monitoringEnd(loopName);\n  }\n\n  addLoop(loopName: string, iterationCallback: (delta: number) => void) {\n    if (this.loops[loopName]) {\n      throw new Error();\n    }\n    this.loops[loopName] = iterationCallback;\n  }\n\n  getType(): string {\n    return FrameLoop.name;\n  }\n}\n","import { WebpackLazyModule } from \"@root/lib/modules/core/loader/WebpackLoader\";\nimport {\n  LazyServices,\n  Service,\n} from \"@root/lib/modules/core/service/LazyServices\";\nimport Component from \"@root/lib/modules/core/ecs/Component\";\nimport { WorldEntity } from \"@root/lib/modules/core/ecs/WorldEntity\";\nimport { ServiceEntity } from \"@root/lib/modules/core/service/ServiceEntity\";\nimport { CodeLoaderComponent } from \"@root/lib/modules/core/loader/CodeLoaderComponent\";\n\nexport class Factory implements WebpackLazyModule, Service<WorldService> {\n  constructor() {}\n\n  async createService(services: LazyServices): Promise<WorldService> {\n    return new WorldService(services);\n  }\n}\n\n//(await axolotis.worlds[1].components[0].service[\"@root/lib/modules/core/WorldService:Factory\"]).setActiveWorld(1)\n\ndeclare let window: any;\n\nlet activeWorld = -1;\nlet worlds: WorldEntity[] = [];\nlet addOnWorldChangeCallback: (() => void)[] = []; //do not use events emitter here to avoid surcharing dependencies in the code modules\nlet addOnWorldAddedCallback: (() => void)[] = []; //do not use events emitter here to avoid surcharing dependencies in the code modules\n\nexport function registerNewWorld(worldEntity: WorldEntity) {\n  worlds.push(worldEntity);\n  if (activeWorld < 0) {\n    activeWorld = 0;\n    window.axolotis.world = worlds[activeWorld];\n    window.axolotis.activeWorld = activeWorld;\n  }\n}\n\nif (window) {\n  if (!window.axolotis) {\n    window.axolotis = {};\n  }\n  window.axolotis.worlds = worlds;\n  window.axolotis.activeWorld = activeWorld;\n}\n\nexport class WorldService implements Component {\n  private world: WorldEntity;\n\n  constructor(services: LazyServices) {\n    console.log(\"info\");\n    let worldtmp: any = null;\n    for (const world of this.getWorlds()) {\n      let serviceEntity = world.getFirstComponentByType<ServiceEntity>(\n        ServiceEntity.name\n      );\n      if (serviceEntity == services) {\n        worldtmp = world;\n      }\n    }\n    if (!worldtmp) {\n      throw new Error();\n    }\n    this.world = worldtmp;\n\n    //new world service is new world event\n    services\n      .getService<CodeLoaderComponent>(\n        \"@root/lib/modules/core/loader/CodeLoaderService\"\n      )\n      .then(async (codeLoader) => {\n        codeLoader.awaitInitialLoading();\n        for (const callback of addOnWorldAddedCallback) {\n          callback();\n        }\n      });\n\n    if (activeWorld >= 0) {\n      this.setActiveWorldByNumber(activeWorld);\n    }\n  }\n\n  getType(): string {\n    return WorldService.name;\n  }\n\n  getWorlds() {\n    return worlds;\n  }\n\n  getActiveWorld() {\n    return worlds[activeWorld];\n  }\n\n  isActiveWorld() {\n    return this.world == this.getActiveWorld();\n  }\n\n  addOnWorldChangeCallback(callback: () => void, init: boolean = false) {\n    addOnWorldChangeCallback.push(callback);\n    if (init) {\n      callback();\n    }\n  }\n\n  addOnWorldAdded(callback: () => void, init: boolean = false) {\n    addOnWorldAddedCallback.push(callback);\n    if (init) {\n      callback();\n    }\n  }\n\n  setActiveWorld(world: WorldEntity) {\n    for (let i = 0; i < this.getWorlds().length; i++) {\n      if (world == this.getWorlds()[i]) {\n        this.setActiveWorldByNumber(i);\n        return;\n      }\n    }\n    throw new Error();\n  }\n\n  setActiveWorldByNumber(number: number) {\n    if (activeWorld != number) {\n      activeWorld = number;\n      if (window && window.axolotis) {\n        window.axolotis.activeWorld = activeWorld;\n        window.axolotis.world = worlds[activeWorld];\n      }\n      for (const callback of addOnWorldChangeCallback) {\n        callback();\n      }\n    }\n  }\n}\n","\n        //Autogenerated\n        /* Webpack use module name for loading and computing code bundle and split chunk so we cannot introduce variable in the import thus we create this redirecting file*/\n        export async function getWebpackClassName(path, classname) {\n            if (path === \"@root/lib/modules/core/WorldService\" && classname === \"Factory\") {\n        let module = await import(\"@root/lib/modules/core/WorldService\");\n        return module.Factory.name;\n    } else if (path === \"@root/lib/modules/FrameLoop\" && classname === \"Factory\") {\n        let module = await import(\"@root/lib/modules/FrameLoop\");\n        return module.Factory.name;\n    } else  {\n                throw new Error(\"Class Not Found\");\n            }\n        }","import { loadModuleAsync } from \"@root/lib/generated/webpack/module/WebpackLoader\";\nimport { getWebpackClassName } from \"@root/lib/generated/webpack/module/ClassNameConverter\";\n\n//TODO separate the concept of of webpack module and world component (see WebpackLoader)\n//Add the concept of service that can lazy load - using everywhere with the same name and no parameters\n// eg three and ammo are singleton service\n// using tuple package + class name like webpack module\n// idea add a system entity in the world that list all the services and maintains unicity?\n// using or not the world API - World entity have a type but the name is set in the class - a little dirty since i do not want to hardcode the package in the class as a name.\n//lazy load entity would be cool tho\n\nexport interface WebpackLazyModule {\n  /* constructor(); should have a constructor */\n}\n\nexport async function instanciateWebpackAsyncModule<T>(\n  importPath: string,\n  classname: string\n): Promise<T> {\n  const module = await loadModuleAsync(importPath);\n  for (const key in module) {\n    const sub = module[key];\n    if (\n      sub.prototype &&\n      sub.prototype.constructor.name ===\n        (await getWebpackClassName(importPath, classname))\n    ) {\n      //identifiying the module\n      return new sub();\n    }\n  }\n  throw new Error(\"invalid factory \" + importPath + \" - \" + classname);\n}\n","\n        export async function loadModuleAsync(name):Promise<any> {\n            //Autogenerated\n            /* Webpack use module name for loading and computing code bundle and split chunk so we cannot introduce variable in the import thus we create this redirecting file*/\n            switch (name) {\n                \n            case \"@root/lib/modules/core/WorldService\": return import(\"@root/lib/modules/core/WorldService\");\n            case \"@root/lib/modules/FrameLoop\": return import(\"@root/lib/modules/FrameLoop\");\n                default: throw new Error(name+\" not found in module list - please run npm run pre-build\");\n            }\n        }","import { ComponentFactory } from \"@root/lib/modules/core/ecs/ComponentFactory\";\nimport Component from \"@root/lib/modules/core/ecs/Component\";\nimport { instanciateWebpackAsyncModule } from \"@root/lib/modules/core/loader/WebpackLoader\";\nimport { instanciateLocalAsyncModule } from \"@root/lib/modules/core/loader/LocalLoader\";\n\nlet localModules: { [id: string]: () => Promise<any> } = {};\n\nexport function registerLocalModule(name:string,module:() => Promise<any>){\n  localModules[name]=module;\n}\n\nexport async function instanciateJsAsyncModule<T>(\n  moduleName: string,\n  classname: string\n): Promise<T> {\n  let module = null;\n  if (localModules[moduleName]) {\n    module = await instanciateLocalAsyncModule<ComponentFactory<Component>>(\n      moduleName,\n      classname,\n      localModules\n    );\n  } else {\n    module = await instanciateWebpackAsyncModule<ComponentFactory<Component>>(\n      moduleName,\n      classname\n    );\n  }\n  return module;\n}\n","import { getWebpackClassName } from \"@root/lib/generated/webpack/module/ClassNameConverter\";\n\nexport async function instanciateLocalAsyncModule<T>(\n  moduleName: string,\n  classname: string,\n  localModules: { [id: string]: () => Promise<any> } = {}\n): Promise<T> {\n  const module = await localModules[moduleName]();\n  for (const key in module) {\n    const sub = module[key];\n    if (sub.prototype && sub.prototype.constructor.name === classname) {\n      //identifiying the module\n      return new sub();\n    }\n  }\n  throw new Error(\"invalid factory \" + moduleName + \" - \" + classname);\n}\n","import { instanciateWebpackAsyncModule } from \"@root/lib/modules/core/loader/WebpackLoader\";\nimport Component from \"@root/lib/modules/core/ecs/Component\";\nimport { instanciateJsAsyncModule } from \"@root/lib/modules/core/loader/JsLoader\";\n\nexport interface Service<T> {\n  createService(services: LazyServices): Promise<T>;\n}\n\nexport class LazyServices {\n  service: { [id: string]: Promise<Component> | undefined } = {};\n\n  toId(path, classname) {\n    return path + \":\" + classname;\n  }\n\n  /* async getServiceFromModue<T>(modulePromise:Promise<any>, classname:string = \"Factory\"):Promise<any>{\n\n    }*/\n\n  setService(path: string, service: Component, classname: string = \"Factory\") {\n    this.service[this.toId(path, classname)] = Promise.resolve(service);\n  }\n\n  async getService<T extends Component>(\n    path: string,\n    classname: string = \"Factory\"\n  ): Promise<T> {\n    if (this.service[this.toId(path, classname)]) {\n      const module = await this.service[this.toId(path, classname)];\n      if (!module) {\n        throw new Error(\"error\");\n      }\n      return module as T;\n    }\n    if (!this.service[this.toId(path, classname)]) {\n      let modulePromise = instanciateJsAsyncModule<Service<T>>(path, classname);\n      this.service[this.toId(path, classname)] = new Promise(\n        async (resolve) => {\n          let t: Component = await (await modulePromise).createService(this);\n          resolve(t);\n        }\n      );\n    }\n    return (await this.service[this.toId(path, classname)]) as T;\n  }\n}\n","import Component from \"@root/lib/modules/core/ecs/Component\";\nimport { LazyServices } from \"@root/lib/modules/core/service/LazyServices\";\n\nexport class ServiceEntity extends LazyServices implements Component {\n  getType(): string {\n    return ServiceEntity.name;\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t826: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkaxolotis_player\"] = self[\"webpackChunkaxolotis_player\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","import Component from \"@root/lib/modules/core/ecs/Component\";\nimport {load} from \"@root/lib/modules/core/loader/CodeLoader\";\nimport {loadAssets} from \"@root/lib/modules/core/loader/AssetsLoader\";\nimport {ComponentFactory} from \"@root/lib/modules/core/ecs/ComponentFactory\";\nimport {WorldEntity} from \"@root/lib/modules/core/ecs/WorldEntity\";\nimport {ServiceEntity} from \"@root/lib/modules/core/service/ServiceEntity\";\nimport {\n    instanciateJsAsyncModule,\n} from \"@root/lib/modules/core/loader/JsLoader\";\n\nexport class CodeLoaderComponent implements Component {\n    private initialLoading: Promise<any>;\n    private initialLoadingResolver: ((value: any) => void) | undefined;\n    public roomUrl: string = \"\";\n\n    constructor() {\n        this.initialLoading = new Promise<any>((resolve) => {\n            this.initialLoadingResolver = resolve;\n        });\n    }\n\n    cleanUpRoomUrl(roomUrl: string) {\n        if (!roomUrl.endsWith(\".json\")) {\n            roomUrl += \"/room.json\";\n        }\n        roomUrl.replace(\"./\", \"\");\n        if (!roomUrl.startsWith(\"http\")) {\n            roomUrl = window.location.origin + \"/\" + roomUrl;\n        }\n        return roomUrl;\n    }\n\n    async loadRoomDefinitionFile(roomUrl: string) {\n        roomUrl = this.cleanUpRoomUrl(roomUrl);\n        this.roomUrl = roomUrl;\n        let response = await fetch(roomUrl);\n        return await response.json();\n    }\n\n    async searchRoomDefinitionFile() {\n        //how to find a room\n        //1 - search in window.axolotis.room\n        //2 - search in meta tag\n        if ((window as any).axolotis && (window as any).axolotis.room) {\n            return (window as any).axolotis.room;\n        }\n        // @ts-ignore\n        for (const tag of window.document.head.children) {\n            if (tag.tagName === \"META\" && (tag as any).name === \"axolotis:room\") {\n                let roomUrl = (tag as any).content;\n                return this.loadRoomDefinitionFile(roomUrl);\n            }\n        }\n        throw new Error(\"No room definition found in meta axolotis:room\");\n    }\n\n    getType(): string {\n        return CodeLoaderComponent.name;\n    }\n\n    async awaitInitialLoading() {\n        await this.initialLoading;\n    }\n\n    async startLoadingJson(\n        world: WorldEntity,\n        scene: {\n            version: string,\n            entities: { components: { module: string, config: any,classname: string|undefined }[] }[],\n            services: { module: string }[]\n        },\n        loadedCallBack: (progress: number, total: number) => void\n    ) {\n        let promises: (() => Promise<any>)[] = [];\n        for (const entity of scene.entities) {\n            for (const componentDef of entity.components) {\n                let config = componentDef.config;\n                promises.push(() => new Promise(async (resolve, reject) => {\n                  let classname = componentDef.classname || \"Factory\";\n                    const module = await instanciateJsAsyncModule<ComponentFactory<Component>>(componentDef.module, classname);\n                    let component = await module.createComponent(\n                        world,\n                        config || {}\n                    );\n                    if (!component.getType) {\n                        throw new Error(\n                            \"Not a component : \" + componentDef.module + \" \" + component.constructor.name\n                        );\n                    }\n                    world.addComponent(component);//TODO world default but should ad to an entity\n                    resolve(module);\n                }));\n            }\n        }\n\n        for (const serviceDef of scene.services) {\n          promises.push(() => new Promise(async (resolve, reject) => {\n            let service = await world.getFirstComponentByType<ServiceEntity>(ServiceEntity.name);\n            await service.getService<any>(serviceDef.module);\n            resolve(service);\n          }));\n        }\n\n        let promise = load(promises, loadedCallBack);\n        promise.then((value) => {\n            if (this.initialLoadingResolver !== undefined) {\n                this.initialLoadingResolver(value);\n            }\n        });\n        promise.catch((reason) => {\n            console.error(reason);\n        });\n        return promise;\n    }\n}\n","export function load(\n  modules: (() => Promise<any>)[],\n  loadedCallBack: (progress: number, total: number) => void\n) {\n  let ret: any[] = [];\n  let nbLoaded = 0;\n  for (const promiseCb of modules) {\n    const promise = promiseCb(); //trigger the load\n    ret.push(promise);\n    promise.then(() => {\n      nbLoaded++;\n      loadedCallBack(nbLoaded, modules.length);\n    });\n  }\n  return Promise.all(ret);\n}\n","import { DestroyableComponent } from \"./DestroyableComponent\";\nimport { Component } from \"./Component\";\n\nexport class Entity implements Component {\n  private components: Component[] = [];\n  private waitingForComponent: { [id: string]: any[] } = {};\n\n  constructor(private name: string) {}\n\n  public addComponent<T extends Component>(component: T): T {\n    this.components.push(component);\n\n    //part for async getComponent\n    if (this.waitingForComponent[component.getType()]) {\n      for (const elem of this.waitingForComponent[component.getType()]) {\n        elem(component);\n      }\n      delete this.waitingForComponent[component.getType()];\n    }\n\n    return component;\n  }\n\n  public removeAllComponents() {\n    this.components.forEach((comp) => {\n      this.removeComponent(comp);\n    });\n  }\n\n  public removeComponent<T extends Component>(component: T): T {\n    if (\"destroy\" in component) {\n      (component as any as DestroyableComponent).destroy();\n    }\n    this.components = this.components.filter((comp) => {\n      return comp != component;\n    });\n    return component;\n  }\n\n  public addComponents(components: Component[]) {\n    components.forEach((comp) => {\n      this.addComponent(comp);\n    });\n  }\n\n  public getComponents(): Component[] {\n    return this.components;\n  }\n\n  public getComponentByType<T extends Component>(type: string): T[] {\n    let ret: T[] = [];\n    this.components.forEach((comp) => {\n      if (comp.getType() === type) {\n        ret.push(comp as T);\n      }\n    });\n    return ret;\n  }\n\n  public getComponentByTypeStartsWith(type: string): Component[] {\n    let ret: Component[] = [];\n    this.components.forEach((comp) => {\n      if (comp.getType().startsWith(type)) {\n        ret.push(comp);\n      }\n    });\n    return ret;\n  }\n\n  public getFirstComponentByTypeStartsWith<T extends Component>(\n    type: string\n  ): T {\n    return this.getComponentByTypeStartsWith(type)[0] as T;\n  }\n\n  public getFirstComponentByType<T extends Component>(type: string): T {\n    return this.getComponentByType(type)[0] as T;\n  }\n\n  public async getFirstComponentByTypeAsync<T extends Component>(\n    type: string\n  ): Promise<T> {\n    if (this.getComponentByType(type)[0]) {\n      return this.getComponentByType(type)[0] as T;\n    } else {\n      if (!this.waitingForComponent[type]) {\n        this.waitingForComponent[type] = [];\n      }\n      let promise = new Promise<T>((resolve, reject) => {\n        this.waitingForComponent[type].push(resolve); //will resolve later\n      });\n      return promise;\n    }\n  }\n\n  public getType(): string {\n    return this.name;\n  }\n}\n\nexport default Entity;\n","import Entity from \"@root/lib/modules/core/ecs/Entity\";\nimport { registerNewWorld } from \"@root/lib/modules/core/WorldService\";\n\nexport class WorldEntity extends Entity {\n  constructor() {\n    super(\"world\");\n    registerNewWorld(this);\n  }\n}\n","import {CodeLoaderComponent} from \"@root/lib/modules/core/loader/CodeLoaderComponent\";\nimport {ServiceEntity} from \"@root/lib/modules/core/service/ServiceEntity\";\nimport {WorldEntity} from \"@root/lib/modules/core/ecs/WorldEntity\";\n\nexport const BUILD_VERSION = require(\"../../../../../package.json\").version;\nconsole.log(BUILD_VERSION);\n\nconst domReady = (callBack: () => void) => {\n    if (document.readyState === \"loading\") {\n        document.addEventListener('DOMContentLoaded', callBack);\n    } else {\n        callBack();\n    }\n};\n\nconst windowReady = (callBack: () => void) => {\n    if (document.readyState === 'complete') {\n        callBack();\n    } else {\n        window.addEventListener('load', callBack);\n    }\n};\n\nexport function initHtml() {\n    let serviceEntity = new ServiceEntity();\n    let world = new WorldEntity();\n    world.addComponent(serviceEntity);\n    let codeLoaderComponent = new CodeLoaderComponent();\n    serviceEntity.setService(\n        \"@root/lib/modules/core/loader/CodeLoaderService\",\n        codeLoaderComponent\n    );\n    windowReady(() => {\n        let scene: HTMLCollection = window.document.body.getElementsByTagName(\"ax-scene\");//TODO assume only one scene\n        codeLoaderComponent.startLoadingJson(world, htmlToJson(scene), (progress, total) => {\n            console.log(\"[\" + progress + \"/\" + total + \"]\");\n            const progressbar: any = document.getElementById(\"progress\");\n            progressbar.style.width = `${(progress / total) * 100}%`;\n        }).then(() => {\n            console.log(\"loading complete\");\n            (document.getElementById(\"progresscontainer\") as any).className +=\n                \"load\";\n        });\n    });\n}\n\nfunction htmlToJson(scene: HTMLCollection): {\n    version: string,\n    entities: { components: { module: string, config: any,classname: string|undefined }[] }[],\n    services: { module: string }[]\n} {\n    let sceneEl = scene[0];\n    const ret= {\n        version: \"2.0\",\n        entities:[],\n        services: []\n    };\n    // @ts-ignore\n    for (const entity of sceneEl.getElementsByTagName(\"ax-entity\")) {\n        //§§§ ICI sdhdfhdfshdf\n        let entityRet = {components:[]};\n\n        for (const componentEl of entity.getElementsByTagName(\"ax-component\")) {\n            //convert relaxed json to proper json\n            let correctJson = componentEl.getAttribute(\"config\").replace(/(['\"])?([a-z0-9A-Z_]+)(['\"])?:/g, '\"$2\": ');\n            let component = {\n                module:componentEl.getAttribute(\"module\"),\n                config:JSON.parse(correctJson)\n            };\n            entityRet.components.push(component);\n        }\n        ret.entities.push(entityRet)\n    }\n    // @ts-ignore\n    for (const service of sceneEl.getElementsByTagName(\"ax-service\")) {\n        ret.services.push({module:service.getAttribute(\"module\")});\n    }\n    return ret;\n}\n\nexport function initJson() {\n    let serviceEntity = new ServiceEntity();\n    let world = new WorldEntity();\n    world.addComponent(serviceEntity);\n    let codeLoaderComponent = new CodeLoaderComponent();\n    serviceEntity.setService(\n        \"@root/lib/modules/core/loader/CodeLoaderService\",\n        codeLoaderComponent\n    );\n    codeLoaderComponent.searchRoomDefinitionFile().then((json) => {\n        codeLoaderComponent\n            .startLoadingJson(world, json.entities, (progress, total) => {\n                console.log(\"[\" + progress + \"/\" + total + \"]\");\n                const progressbar: any = document.getElementById(\"progress\");\n                progressbar.style.width = `${(progress / total) * 100}%`;\n            })\n            .then(() => {\n                console.log(\"loading complete\");\n                (document.getElementById(\"progresscontainer\") as any).className +=\n                    \"load\";\n            });\n    });\n}\n","/*\nplease do not add static import\n */\nexport class AssetsLoader {\n  loaderCache = {};\n  assets = {};\n\n  async getLoader(loaderName: string, loaderLoader: () => void) {\n    if (!this.loaderCache[loaderName]) {\n      this.loaderCache[loaderName] = await loaderLoader();\n    }\n    return this.loaderCache[loaderName];\n  }\n}\n\nexport const assetsLoader: AssetsLoader = new AssetsLoader();\n\nexport async function loadAssets(path: string) {\n  if (assetsLoader.assets[path]) {\n    return assetsLoader.assets[path];\n  }\n  /*\n    TODO createa a early start download of assets so that the GLB start downloading early in the waterfall\n    Not as simple as it seems may be doable using service worker\n    fetch(path);//start download of assets\n    var oReq = new XMLHttpRequest();\n    oReq.addEventListener(\"load\", ()=>{});\n    oReq.open(\"GET\", path);\n    oReq.send();\n    */\n  if (path.endsWith(\".glb\")) {\n    const loader = await assetsLoader.getLoader(\"GLTFLoader\", async () => {\n      const GLTFLoader: any = await import(\n        \"three/examples/jsm/loaders/GLTFLoader\"\n      );\n      const gltfLoader = new GLTFLoader.GLTFLoader();\n      return gltfLoader;\n    });\n    const result = await loader.loadAsync(path);\n    assetsLoader.assets[path] = result;\n  }\n  if (path.endsWith(\".jpg\")) {\n    const loader = await assetsLoader.getLoader(\"TextureLoader\", async () => {\n      const THREE: any = await import(\"three\");\n      const texLoader = new THREE.TextureLoader();\n      return texLoader;\n    });\n    const result = await loader.loadAsync(path);\n    assetsLoader.assets[path] = result;\n  }\n  return assetsLoader.assets[path];\n}\n"],"names":["root","factory","exports","module","define","amd","self","inProgress","dataWebpackPrefix","Factory","services","codeLoader","getService","FrameLoop","awaitInitialLoading","then","startAnimationFrameLoop","constructor","animate","t","this","monitoringStart","name","delta","prevTime","requestAnimationFrame","callback","loops","monitoringEnd","setMonitoringCallback","start","end","removeLoop","loopName","addLoop","iterationCallback","Error","getType","WorldService","activeWorld","worlds","addOnWorldChangeCallback","addOnWorldAddedCallback","registerNewWorld","worldEntity","push","window","axolotis","world","console","log","worldtmp","getWorlds","getFirstComponentByType","ServiceEntity","async","setActiveWorldByNumber","getActiveWorld","isActiveWorld","init","addOnWorldAdded","setActiveWorld","i","length","number","getWebpackClassName","path","classname","instanciateWebpackAsyncModule","importPath","loadModuleAsync","key","sub","prototype","localModules","registerLocalModule","instanciateJsAsyncModule","moduleName","instanciateLocalAsyncModule","LazyServices","toId","setService","service","Promise","resolve","modulePromise","createService","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","m","d","definition","o","Object","defineProperty","enumerable","get","f","e","chunkId","all","keys","reduce","promises","u","miniCssF","g","globalThis","Function","obj","prop","hasOwnProperty","call","l","url","done","script","needAttach","scripts","document","getElementsByTagName","s","getAttribute","createElement","charset","timeout","nc","setAttribute","src","onScriptComplete","prev","event","onerror","onload","clearTimeout","doneFns","parentNode","removeChild","forEach","fn","setTimeout","bind","type","target","head","appendChild","r","Symbol","toStringTag","value","scriptUrl","importScripts","location","currentScript","replace","p","installedChunks","j","installedChunkData","promise","reject","error","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","data","chunkIds","moreModules","runtime","some","id","chunkLoadingGlobal","CodeLoaderComponent","initialLoading","initialLoadingResolver","cleanUpRoomUrl","roomUrl","endsWith","startsWith","origin","response","fetch","json","room","tag","children","tagName","content","loadRoomDefinitionFile","scene","loadedCallBack","entity","entities","componentDef","components","config","component","createComponent","addComponent","serviceDef","modules","ret","nbLoaded","promiseCb","load","catch","reason","waitingForComponent","elem","removeAllComponents","comp","removeComponent","destroy","filter","addComponents","getComponents","getComponentByType","getComponentByTypeStartsWith","getFirstComponentByTypeStartsWith","WorldEntity","Entity","super","BUILD_VERSION","require","initHtml","serviceEntity","codeLoaderComponent","callBack","body","startLoadingJson","sceneEl","version","entityRet","componentEl","correctJson","JSON","parse","htmlToJson","progress","total","getElementById","style","width","className","readyState","addEventListener","AssetsLoader","loaderName","loaderLoader","loaderCache"],"sourceRoot":""}